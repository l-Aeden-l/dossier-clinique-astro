---
// PAGE C : ANAMN√àSE CHRONOLOGIQUE
// Mise en page de type "Documentation Technique" avec sidebar de navigation par dates
// Sections : 1979-1984 (ASE), 1986-1995 (Maltraitances), 1995-1998 (Apprentis d'Auteuil), 2022-2026 (Hontaut/Villeneuve)

import MainLayout from '../layouts/MainLayout.astro';

// Props pour le layout
const pageTitle = 'Anamn√®se Chronologique';
const showHero = true;
const heroTitle = 'Anamn√®se Chronologique';
const heroDescription = 'Historique m√©dical et parcours de vie - Documentation technique';
const breadcrumbs = [
  { label: 'Anamn√®se Chronologique' }
];

// P√©riodes chronologiques
const chronologicalPeriods = [
  { id: '1979-1984', label: '1979-1984', title: 'ASE - Aide Sociale √† l\'Enfance', description: 'Prise en charge institutionnelle pr√©coce' },
  { id: '1986-1995', label: '1986-1995', title: 'P√©riode de Maltraitances', description: 'Contexte familial difficile' },
  { id: '1995-1998', label: '1995-1998', title: 'Apprentis d\'Auteuil', description: 'Structure √©ducative sp√©cialis√©e' },
  { id: '1998-2022', label: '1998-2022', title: 'Vie Adulte - Insertion Professionnelle', description: 'Parcours professionnel et difficult√©s d\'adaptation' },
  { id: '2022-2026', label: '2022-2026', title: 'Hontaut / Villeneuve-sur-Lot', description: 'Diagnostic TSA et prise en charge actuelle' }
];
---

<MainLayout 
  title={pageTitle} 
  showHero={showHero}
  heroTitle={heroTitle}
  heroDescription={heroDescription}
  breadcrumbs={breadcrumbs}
>
  <div class="timeline-container">
    <aside class="timeline-sidebar">
      <nav class="periods-nav" aria-label="Navigation par p√©riodes">
        <h3 class="sidebar-title">P√©riodes Chronologiques</h3>
        <ul class="periods-list">
          {chronologicalPeriods.map((period) => (
            <li class="period-item">
              <a 
                href={`#${period.id}`} 
                class="period-link"
                data-period={period.id}
              >
                <span class="period-label">{period.label}</span>
                <span class="period-title">{period.title}</span>
              </a>
            </li>
          ))}
        </ul>
      </nav>

      <div class="documents-legend">
        <h4 class="legend-title">Types de Documents</h4>
        <ul class="legend-list">
          <li class="legend-item medical">
            <span class="legend-icon">üè•</span>
            Documents M√©dicaux
          </li>
          <li class="legend-item social">
            <span class="legend-icon">üè†</span>
            Documents Sociaux
          </li>
          <li class="legend-item administrative">
            <span class="legend-icon">üìã</span>
            Documents Administratifs
          </li>
          <li class="legend-item personal">
            <span class="legend-icon">üìù</span>
            R√©cits Personnels
          </li>
        </ul>
      </div>
    </aside>

    <main class="timeline-content">
      {chronologicalPeriods.map((period, index) => (
        <section id={period.id} class="period-section">
          <div class="period-header">
            <h2 class="period-title">{period.title} <span class="period-years">({period.label})</span></h2>
            <p class="period-description">{period.description}</p>
          </div>

          <div class="period-content">
            <div class="period-documents">
              <h3>Documents Associ√©s</h3>
              
              <div class="documents-grid">
                <div class="document-card medical">
                  <div class="document-icon">üè•</div>
                  <div class="document-content">
                    <h4>Comptes-rendus M√©dicaux</h4>
                    <p><em>[D√©tails des comptes-rendus pour {period.label}]</em></p>
                    <ul class="document-list">
                      <li>[R√©f√©rence document 1]</li>
                      <li>[R√©f√©rence document 2]</li>
                    </ul>
                  </div>
                </div>

                <div class="document-card social">
                  <div class="document-icon">üè†</div>
                  <div class="document-content">
                    <h4>Documents Sociaux</h4>
                    <p><em>[Rapports sociaux et √©ducatifs - {period.label}]</em></p>
                    <ul class="document-list">
                      <li>[Rapports ASE/Educateurs]</li>
                      <li>[√âvaluations sociales]</li>
                    </ul>
                  </div>
                </div>

                <div class="document-card personal">
                  <div class="document-icon">üìù</div>
                  <div class="document-content">
                    <h4>R√©cits et T√©moignages</h4>
                    <div class="narrative-placeholder">
                      <p>[Description des √©v√©nements marquants et ressentis pour cette p√©riode]</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="period-analysis">
              <h3>Analyse Clinique R√©trospective</h3>
              <div class="analysis-content">
                <div class="analysis-points">
                  <h4>Points Cl√©s :</h4>
                  <ul>
                    <li>Facteurs de risque identifi√©s</li>
                    <li>Ressources et protection</li>
                    <li>Impact sur le d√©veloppement</li>
                    <li>Liens avec le diagnostic actuel</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="period-navigation">
              {index > 0 && (
                <a 
                  href={`#${chronologicalPeriods[index - 1].id}`} 
                  class="nav-link prev-period"
                >
                  ‚Üê {chronologicalPeriods[index - 1].label}
                </a>
              )}
              
              {index < chronologicalPeriods.length - 1 && (
                <a 
                  href={`#${chronologicalPeriods[index + 1].id}`} 
                  class="nav-link next-period"
                >
                  {chronologicalPeriods[index + 1].label} ‚Üí
                </a>
              )}
            </div>
          </div>
        </section>
      ))}
    </main>
  </div>
</MainLayout>

<style>
  /* ----------------------------------------------------------------------
     STRUCTURE PRINCIPALE
     ---------------------------------------------------------------------- */
  .timeline-container {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: var(--spacing-xl);
    min-height: 100vh;
  }

  /* ----------------------------------------------------------------------
     SIDEBAR DE NAVIGATION
     ---------------------------------------------------------------------- */
  .timeline-sidebar {
    position: sticky;
    top: calc(var(--spacing-xl) * 2);
    align-self: start;
    max-height: calc(100vh - var(--spacing-xl) * 4);
    overflow-y: auto;
    padding-right: var(--spacing-md);
  }

  .sidebar-title {
    font-size: 1.125rem;
    color: var(--color-primary);
    margin-bottom: var(--spacing-md);
    border-bottom: 2px solid var(--color-primary);
    padding-bottom: var(--spacing-sm);
  }

  .periods-list {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .period-item {
    margin-bottom: var(--spacing-xs);
  }

  .period-link {
    display: block;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-md);
    text-decoration: none;
    color: var(--color-gray-700);
    border-left: 3px solid transparent;
    transition: all var(--transition-base);
  }

  .period-link:hover {
    background-color: var(--color-primary-light);
    color: var(--color-primary);
    border-left-color: var(--color-primary);
  }

  .period-label {
    display: block;
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--color-gray-900);
  }

  .period-title {
    display: block;
    font-size: 0.75rem;
    color: var(--color-gray-600);
    margin-top: var(--spacing-xs);
  }

  /* ----------------------------------------------------------------------
     L√âGENDE DES DOCUMENTS
     ---------------------------------------------------------------------- */
  .documents-legend {
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-lg);
    border-top: 1px solid var(--color-gray-200);
  }

  .legend-list {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-xs) 0;
    font-size: 0.875rem;
    color: var(--color-gray-600);
  }

  .legend-icon {
    font-size: 1rem;
    width: 24px;
    text-align: center;
  }

  /* ----------------------------------------------------------------------
     CONTENU DES P√âRIODES
     ---------------------------------------------------------------------- */
  .timeline-content {
    padding-bottom: var(--spacing-3xl);
  }

  .period-section {
    margin-bottom: var(--spacing-3xl);
    scroll-margin-top: var(--spacing-xl);
  }

  .period-header {
    margin-bottom: var(--spacing-xl);
    padding-bottom: var(--spacing-lg);
    border-bottom: 2px solid var(--color-gray-200);
  }

  .period-title {
    font-size: 2rem;
    color: var(--color-primary);
    margin-bottom: var(--spacing-sm);
  }

  .period-years {
    font-size: 1.5rem;
    color: var(--color-gray-600);
    font-weight: 400;
  }

  .period-description {
    font-size: 1.125rem;
    color: var(--color-gray-700);
    max-width: 80ch;
  }

  /* ----------------------------------------------------------------------
     DOCUMENTS ET CARTES
     ---------------------------------------------------------------------- */
  .documents-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-lg);
  }

  .document-card {
    padding: var(--spacing-lg);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--color-gray-200);
    background-color: var(--color-white);
  }

  .document-card.medical { border-top: 4px solid #ef4444; }
  .document-card.social { border-top: 4px solid #3b82f6; }
  .document-card.personal { border-top: 4px solid #f59e0b; }

  .narrative-placeholder {
    padding: var(--spacing-md);
    background-color: var(--color-gray-50);
    border-radius: var(--border-radius-md);
    font-style: italic;
  }

  /* ----------------------------------------------------------------------
     ANALYSE ET NAVIGATION
     ---------------------------------------------------------------------- */
  .period-analysis {
    margin-top: var(--spacing-xl);
    padding: var(--spacing-lg);
    background-color: var(--color-primary-light);
    border-radius: var(--border-radius-md);
    border-left: 4px solid var(--color-primary);
  }

  .period-navigation {
    display: flex;
    justify-content: space-between;
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-lg);
    border-top: 1px solid var(--color-gray-200);
  }

  .nav-link {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
  }

  .nav-link:hover { text-decoration: underline; }

  /* ----------------------------------------------------------------------
     RESPONSIVE
     ---------------------------------------------------------------------- */
  @media (max-width: 992px) {
    .timeline-container { grid-template-columns: 1fr; }
    .timeline-sidebar { position: static; max-height: none; }
  }
</style>