---
// Page Archives et Documents
import MainLayout from '../layouts/MainLayout.astro';

// Cat√©gories de documents
const documentCategories = [
  {
    id: "medical",
    title: "Documents M√©dicaux",
    description: "Bilans, √©valuations et rapports m√©dicaux",
    icon: "üè•",
    documents: [
      {
        id: "ados-2024",
        title: "Bilan ADOS-2 complet",
        description: "√âvaluation diagnostique TSA avec score d√©taill√© (2024)",
        date: "15/03/2024",
        size: "2.4 MB",
        format: "PDF",
        pages: 18,
        author: "Dr. Sophie Martin",
        downloadLink: "/documents/ados-2024.pdf",
        previewAvailable: true
      },
      {
        id: "psychiatric-report-2024",
        title: "Compte-rendu psychiatrique",
        description: "Synth√®se du suivi psychiatrique et recommandations th√©rapeutiques",
        date: "15/11/2024",
        size: "1.8 MB",
        format: "PDF",
        pages: 12,
        author: "Dr. Sophie Martin",
        downloadLink: "/documents/psychiatric-report-2024.pdf",
        previewAvailable: true
      },
      {
        id: "beck-evaluations-2026",
        title: "√âvaluations psychom√©triques",
        description: "R√©sultats des questionnaires de Beck (d√©pression et anxi√©t√©)",
        date: "15/01/2026",
        size: "1.2 MB",
        format: "PDF",
        pages: 8,
        author: "Dr. Dubois",
        downloadLink: "/documents/beck-evaluations-2026.pdf",
        previewAvailable: true
      },
      {
        id: "cognitive-assessment",
        title: "Bilan cognitif complet",
        description: "√âvaluation des fonctions cognitives et profil neuropsychologique",
        date: "20/02/2025",
        size: "3.1 MB",
        format: "PDF",
        pages: 22,
        author: "Dr. Laurent",
        downloadLink: "/documents/cognitive-assessment.pdf",
        previewAvailable: false
      }
    ]
  },
  {
    id: "social",
    title: "Documents Sociaux et Administratifs",
    description: "Dossiers administratifs, demandes et notifications",
    icon: "üìã",
    documents: [
      {
        id: "aah-notification",
        title: "Notification AAH",
        description: "D√©cision d'attribution de l'Allocation Adulte Handicap√©",
        date: "15/10/2024",
        size: "0.8 MB",
        format: "PDF",
        pages: 4,
        author: "MDPH 47",
        downloadLink: "/documents/aah-notification.pdf",
        previewAvailable: true
      },
      {
        id: "hlm-application",
        title: "Demande de logement social",
        description: "Dossier complet de demande HLM avec pi√®ces jointes",
        date: "15/01/2025",
        size: "4.2 MB",
        format: "PDF",
        pages: 28,
        author: "CMS Villeneuve-sur-Lot",
        downloadLink: "/documents/hlm-application.pdf",
        previewAvailable: true
      },
      {
        id: "social-report",
        title: "Rapport social complet",
        description: "√âvaluation sociale et plan d'accompagnement personnalis√©",
        date: "05/06/2025",
        size: "2.1 MB",
        format: "PDF",
        pages: 15,
        author: "N√©g√¢r REZAI ARIA",
        downloadLink: "/documents/social-report.pdf",
        previewAvailable: true
      },
      {
        id: "volunteer-contract",
        title: "Contrat d'engagement b√©n√©vole",
        description: "Convention de b√©n√©volat avec Byblos et B√©n√©voles du 47",
        date: "10/03/2025",
        size: "0.5 MB",
        format: "PDF",
        pages: 3,
        author: "Byblos",
        downloadLink: "/documents/volunteer-contract.pdf",
        previewAvailable: true
      }
    ]
  },
  {
    id: "personal",
    title: "R√©cits et Documents Personnels",
    description: "T√©moignages, r√©cits de vie et productions personnelles",
    icon: "üìñ",
    documents: [
      {
        id: "life-story",
        title: "R√©cit de vie autobiographique",
        description: "Histoire de vie compl√®te de 1979 √† aujourd'hui",
        date: "15/12/2025",
        size: "3.8 MB",
        format: "PDF",
        pages: 45,
        author: "Fr√©d√©ric HAUGUEL",
        downloadLink: "/documents/life-story.pdf",
        previewAvailable: true
      },
      {
        id: "therapy-journal",
        title: "Journal th√©rapeutique (extraits)",
        description: "S√©lection d'extraits du journal personnel (2024-2026)",
        date: "30/01/2026",
        size: "2.7 MB",
        format: "PDF",
        pages: 32,
        author: "Fr√©d√©ric HAUGUEL",
        downloadLink: "/documents/therapy-journal.pdf",
        previewAvailable: false
      },
      {
        id: "testimonials",
        title: "T√©moignages d'intervenants",
        description: "Recueil de t√©moignages de professionnels et proches",
        date: "28/02/2026",
        size: "1.5 MB",
        format: "PDF",
        pages: 10,
        author: "Collectif",
        downloadLink: "/documents/testimonials.pdf",
        previewAvailable: true
      },
      {
        id: "project-proposal",
        title: "Projet de vie et objectifs",
        description: "Document de pr√©sentation du projet associatif et personnel",
        date: "15/02/2026",
        size: "2.3 MB",
        format: "PDF",
        pages: 18,
        author: "Fr√©d√©ric HAUGUEL",
        downloadLink: "/documents/project-proposal.pdf",
        previewAvailable: true
      }
    ]
  },
  {
    id: "legal",
    title: "Documents L√©gaux",
    description: "Documents juridiques et officiels",
    icon: "‚öñÔ∏è",
    documents: [
      {
        id: "consent-form",
        title: "Formulaire de consentement",
        description: "Consentement √©clair√© pour le partage des donn√©es m√©dicales",
        date: "15/03/2024",
        size: "0.3 MB",
        format: "PDF",
        pages: 2,
        author: "CMP Villeneuve-sur-Lot",
        downloadLink: "/documents/consent-form.pdf",
        previewAvailable: true
      },
      {
        id: "privacy-policy",
        title: "Politique de confidentialit√©",
        description: "Engagement de protection des donn√©es personnelles",
        date: "01/01/2026",
        size: "0.4 MB",
        format: "PDF",
        pages: 3,
        author: "Dossier M√©dical Num√©rique",
        downloadLink: "/documents/privacy-policy.pdf",
        previewAvailable: true
      }
    ]
  }
];

// Statistiques des archives
const archiveStats = {
  totalDocuments: documentCategories.reduce((sum, category) => sum + category.documents.length, 0),
  totalSize: "18.7 MB",
  categories: documentCategories.length,
  mostRecent: "30/01/2026",
  averageSize: "1.8 MB",
  pages: 124
};

// Fonction pour formater la taille
function formatSize(sizeMB: string) {
  return `${sizeMB} MB`;
}
---

<MainLayout title="Archives et Documents">
  <div class="container">
    <!-- En-t√™te -->
    <header class="page-header">
      <h1>Centre de Documents et Archives</h1>
      <p class="subtitle">Biblioth√®que compl√®te des documents m√©dicaux, sociaux et personnels</p>
    </header>

    <!-- Navigation secondaire -->
    <nav class="secondary-nav" aria-label="Navigation archives">
      <ul>
        <li><a href="#stats">Statistiques</a></li>
        <li><a href="#medical">Documents M√©dicaux</a></li>
        <li><a href="#social">Documents Sociaux</a></li>
        <li><a href="#personal">Documents Personnels</a></li>
        <li><a href="#legal">Documents L√©gaux</a></li>
      </ul>
    </nav>

    <!-- Section Statistiques -->
    <section id="stats" class="stats-section card">
      <h2>Statistiques des Archives</h2>

      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-value">{archiveStats.totalDocuments}</div>
          <div class="stat-label">Documents totaux</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">{archiveStats.totalSize}</div>
          <div class="stat-label">Espace total</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">{archiveStats.categories}</div>
          <div class="stat-label">Cat√©gories</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">{archiveStats.pages}</div>
          <div class="stat-label">Pages totales</div>
        </div>
      </div>

      <div class="stats-chart">
        <h3>R√©partition par cat√©gorie</h3>
        <div class="chart-container">
          <div class="chart-bar medical" style="width: 40%">
            <span>M√©dical (4)</span>
          </div>
          <div class="chart-bar social" style="width: 30%; left: 40%">
            <span>Social (4)</span>
          </div>
          <div class="chart-bar personal" style="width: 25%; left: 70%">
            <span>Personnel (4)</span>
          </div>
          <div class="chart-bar legal" style="width: 5%; left: 95%">
            <span>L√©gal (2)</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Sections par cat√©gorie -->
    {documentCategories.map(category => (
      <section id={category.id} class="category-section card">
        <h2>{category.icon} {category.title}</h2>
        <p class="category-description">{category.description}</p>

        <div class="documents-grid">
          {category.documents.map(doc => (
            <div class="document-card">
              <div class="document-header">
                <h3>{doc.title}</h3>
                <span class="document-format">{doc.format}</span>
              </div>
              <div class="document-meta">
                <span class="meta-item">üìÖ {doc.date}</span>
                <span class="meta-item">üìÑ {doc.pages} pages</span>
                <span class="meta-item">üíæ {doc.size}</span>
              </div>
              <div class="document-description">
                <p>{doc.description}</p>
                <p class="document-author">Auteur: {doc.author}</p>
              </div>
              <div class="document-actions">
                <a href={doc.downloadLink} class="btn btn-sm" download>
                  üì• T√©l√©charger
                </a>
                {doc.previewAvailable && (
                  <a href={doc.downloadLink} class="btn btn-sm btn-outline" target="_blank">
                    üëÅÔ∏è Pr√©visualiser
                  </a>
                )}
              </div>
            </div>
          ))}
        </div>
      </section>
    ))}

    <!-- Section Recherche -->
    <section class="search-section card">
      <h2>Recherche Avanc√©e</h2>

      <div class="search-form">
        <div class="form-group">
          <label for="search-query">Mots-cl√©s</label>
          <input type="text" id="search-query" placeholder="Rechercher dans les documents...">
        </div>

        <div class="form-group">
          <label for="search-category">Cat√©gorie</label>
          <select id="search-category">
            <option value="">Toutes les cat√©gories</option>
            {documentCategories.map(category => (
              <option value={category.id}>{category.title}</option>
            ))}
          </select>
        </div>

        <div class="form-group">
          <label for="search-date">P√©riode</label>
          <select id="search-date">
            <option value="">Toutes les p√©riodes</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
            <option value="2026">2026</option>
          </select>
        </div>

        <button class="btn">Rechercher</button>
      </div>

      <div class="search-tips">
        <h3>Conseils de recherche</h3>
        <ul>
          <li>Utilisez des mots-cl√©s sp√©cifiques (ex: "ADOS-2", "AAH")</li>
          <li>Filtrez par cat√©gorie pour des r√©sultats plus pertinents</li>
          <li>Consultez les documents r√©cents pour les informations √† jour</li>
          <li>Les documents avec aper√ßu sont marqu√©s d'un symbole üëÅÔ∏è</li>
        </ul>
      </div>
    </section>

    <!-- Section Gestion des Documents -->
    <section class="management-section card">
      <h2>Gestion des Archives</h2>

      <div class="management-info">
        <h3>Comment utiliser cette section</h3>
        <p>Cette biblioth√®que de documents est con√ßue pour un acc√®s facile et s√©curis√© √† tous les documents importants li√©s au suivi m√©dical et social.</p>

        <div class="management-features">
          <div class="feature-item">
            <h4>üîí S√©curit√©</h4>
            <p>Tous les documents sont prot√©g√©s et accessibles uniquement aux personnes autoris√©es.</p>
          </div>
          <div class="feature-item">
            <h4>üì± Accessibilit√©</h4>
            <p>Les documents sont optimis√©s pour une lecture sur tous les appareils.</p>
          </div>
          <div class="feature-item">
            <h4>üîç Organisation</h4>
            <p>Classement clair par cat√©gories et dates pour un acc√®s rapide.</p>
          </div>
          <div class="feature-item">
            <h4>üì§ Export</h4>
            <p>Possibilit√© de t√©l√©charger les documents pour un usage hors ligne.</p>
          </div>
        </div>
      </div>

      <div class="management-actions">
        <h3>Actions disponibles</h3>
        <div class="actions-grid">
          <div class="action-card">
            <h4>üì§ T√©l√©charger tout</h4>
            <p>Obtenir une archive compl√®te</p>
            <button class="btn btn-outline">T√©l√©charger ZIP</button>
          </div>
          <div class="action-card">
            <h4>üìã Demander un document</h4>
            <p>Requ√™te pour un document sp√©cifique</p>
            <button class="btn btn-outline">Faire une demande</button>
          </div>
          <div class="action-card">
            <h4>üîÑ Mettre √† jour</h4>
            <p>Actualiser la liste des documents</p>
            <button class="btn btn-outline">Rafra√Æchir</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Section Aide -->
    <section class="help-section card">
      <h2>Besoin d'Aide ?</h2>

      <div class="help-grid">
        <div class="help-item">
          <h3>üìû Assistance Technique</h3>
          <p>Pour les probl√®mes de t√©l√©chargement ou d'acc√®s</p>
          <p><strong>Contact:</strong> support@dossier-medical.fr</p>
        </div>
        <div class="help-item">
          <h3>üìã Demande de Document</h3>
          <p>Pour demander l'ajout d'un document</p>
          <p><strong>Contact:</strong> archives@dossier-medical.fr</p>
        </div>
        <div class="help-item">
          <h3>üîí Confidentialit√©</h3>
          <p>Pour les questions de protection des donn√©es</p>
          <p><strong>Contact:</strong> dpo@dossier-medical.fr</p>
        </div>
      </div>

      <div class="help-note">
        <p><strong>Note:</strong> Tous les documents sont prot√©g√©s par le secret m√©dical et ne peuvent √™tre partag√©s sans consentement √©crit.</p>
      </div>
    </section>
  </div>

  <!-- Styles sp√©cifiques -->
  <style>
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .stat-item {
      text-align: center;
      padding: var(--spacing-md);
      background-color: white;
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--color-secondary);
      margin-bottom: var(--spacing-sm);
    }

    .stat-label {
      color: var(--color-primary);
      font-size: 0.9rem;
      text-transform: uppercase;
      font-weight: 600;
    }

    .chart-container {
      height: 40px;
      position: relative;
      background-color: #f8f9fa;
      border-radius: var(--border-radius);
      margin: var(--spacing-sm) 0;
    }

    .chart-bar {
      position: absolute;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .chart-bar.medical {
      background-color: var(--color-danger);
    }

    .chart-bar.social {
      background-color: var(--color-warning);
    }

    .chart-bar.personal {
      background-color: var(--color-success);
    }

    .chart-bar.legal {
      background-color: var(--color-primary);
    }

    .category-section {
      margin-bottom: var(--spacing-lg);
    }

    .category-description {
      color: var(--color-primary);
      margin-bottom: var(--spacing-md);
      font-style: italic;
    }

    .documents-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--spacing-md);
    }

    .document-card {
      background-color: white;
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
      overflow: hidden;
      transition: var(--transition);
    }

    .document-card:hover {
      box-shadow: var(--box-shadow);
      transform: translateY(-2px);
    }

    .document-header {
      background-color: var(--color-primary);
      color: white;
      padding: var(--spacing-sm) var(--spacing-md);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .document-format {
      background-color: rgba(255, 255, 255, 0.2);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .document-meta {
      background-color: #f8f9fa;
      padding: var(--spacing-sm) var(--spacing-md);
      display: flex;
      gap: var(--spacing-md);
      border-bottom: 1px solid #ddd;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      font-size: 0.9rem;
      color: var(--color-primary);
    }

    .document-description {
      padding: var(--spacing-md);
    }

    .document-author {
      font-size: 0.8rem;
      color: var(--color-secondary);
      margin-top: var(--spacing-sm);
      font-style: italic;
    }

    .document-actions {
      background-color: white;
      padding: var(--spacing-sm) var(--spacing-md);
      display: flex;
      gap: var(--spacing-sm);
      border-top: 1px solid #ddd;
    }

    .search-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
    }

    .form-group label {
      font-weight: 600;
      color: var(--color-primary);
    }

    .form-group input,
    .form-group select {
      padding: var(--spacing-sm);
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-family: var(--font-primary);
    }

    .search-tips {
      background-color: #f8f9fa;
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
    }

    .management-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
      margin: var(--spacing-md) 0;
    }

    .feature-item {
      text-align: center;
      padding: var(--spacing-sm);
    }

    .actions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
    }

    .action-card {
      text-align: center;
      padding: var(--spacing-md);
      background-color: #f8f9fa;
      border-radius: var(--border-radius);
    }

    .help-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-md);
    }

    .help-item {
      background-color: white;
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
    }

    .help-note {
      background-color: var(--color-warning);
      color: var(--color-dark);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius);
      margin-top: var(--spacing-md);
      font-size: 0.9rem;
    }

    @media (max-width: 768px) {
      .stats-grid,
      .documents-grid,
      .search-form,
      .management-features,
      .actions-grid,
      .help-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</MainLayout>