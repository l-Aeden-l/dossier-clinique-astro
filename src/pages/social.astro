---
// Page R√©alit√©s Sociales et Logement
import MainLayout from '../layouts/MainLayout.astro';

// Donn√©es sociales actuelles
const socialData = {
  currentSituation: {
    location: "Villeneuve-sur-Lot, Lot-et-Garonne",
    housingType: "Sous-sol am√©nag√©",
    housingConditions: {
      heating: "Chauffage au p√©trole",
      insulation: "Faible",
      humidity: "Probl√®mes d'humidit√©",
      size: "25m¬≤",
      amenities: "Acc√®s limit√© √† l'eau chaude"
    },
    neighborhood: "Quartier populaire, acc√®s aux services de base",
    rent: "350‚Ç¨/mois (incluant charges)",
    moveInDate: "Mars 2022"
  },
  socialWorker: {
    name: "N√©g√¢r REZAI ARIA",
    role: "Travailleuse sociale - CMS Villeneuve-sur-Lot",
    contact: "negar.rezai@cms47.fr",
    phone: "05 53 40 12 34",
    affiliation: "Centre M√©dico-Social de Villeneuve-sur-Lot",
    followUpFrequency: "Bimensuel"
  },
  resources: {
    aah: {
      status: "B√©n√©ficiaire",
      amount: "919,86‚Ç¨/mois (2026)",
      startDate: "Novembre 2024",
      endDate: "Octobre 2026",
      notificationDate: "15/10/2024",
      reference: "AAH-2024-75123456"
    },
    housingBenefits: {
      status: "En cours",
      type: "APL (Aide Personnalis√©e au Logement)",
      amount: "120‚Ç¨/mois",
      startDate: "01/01/2025"
    },
    foodAssistance: {
      status: "√âligible",
      type: "√âpicerie sociale",
      frequency: "Hebdomadaire",
      provider: "Secours Populaire"
    }
  }
};

// Demande HLM en cours
const hlmApplication = {
  status: "En instruction",
  submissionDate: "15/01/2025",
  reference: "HLM-47-2025-01234",
  priorityLevel: "Urgent (niveau 2)",
  requestedLocation: "Villeneuve-sur-Lot centre",
  requestedType: "T2 adapt√©",
  expectedTimeline: "6-12 mois",
  supportingDocuments: [
    "Notification AAH",
    "Avis d'imposition",
    "Certificat m√©dical",
    "Attestation de logement pr√©caire"
  ],
  followUp: [
    { date: "15/03/2025", action: "Dossier complet d√©pos√©", status: "‚úì" },
    { date: "05/06/2025", action: "Visite sociale", status: "‚úì" },
    { date: "20/09/2025", action: "Commission d'attribution", status: "En attente" },
    { date: "15/12/2025", action: "D√©cision pr√©vue", status: "√Ä venir" }
  ]
};

// R√©seau de soutien
const supportNetwork = {
  formal: [
    {
      name: "N√©g√¢r REZAI ARIA",
      role: "Travailleuse sociale",
      organization: "CMS Villeneuve-sur-Lot",
      contact: "05 53 40 12 34",
      frequency: "Bimensuel"
    },
    {
      name: "Dr. Sophie Martin",
      role: "Psychiatre",
      organization: "CMP Villeneuve-sur-Lot",
      contact: "05 53 40 56 78",
      frequency: "Mensuel"
    },
    {
      name: "Association Byblos",
      role: "Accompagnement social",
      organization: "Byblos Villeneuve-sur-Lot",
      contact: "05 53 40 90 12",
      frequency: "Hebdomadaire"
    }
  ],
  informal: [
    {
      name: "Jean Dupont",
      role: "B√©n√©vole associ√©",
      relationship: "Connu via Byblos",
      contact: "06 12 34 56 78",
      frequency: "Quotidien (activit√©s communes)"
    },
    {
      name: "Marie Laurent",
      role: "Voisine",
      relationship: "Soutien occasionnel",
      contact: "06 23 45 67 89",
      frequency: "Hebdomadaire"
    }
  ],
  community: [
    {
      name: "B√©n√©voles du 47",
      role: "Association locale",
      activities: "Activit√©s sociales et culturelles",
      contact: "05 53 40 11 22",
      frequency: "Bimensuel"
    },
    {
      name: "Repair Caf√© Villeneuve",
      role: "Atelier participatif",
      activities: "R√©paration d'objets, √©changes",
      contact: "05 53 40 33 44",
      frequency: "Mensuel"
    }
  ]
};

// Besoins identifi√©s
const identifiedNeeds = [
  {
    category: "Logement",
    priority: "Haute",
    description: "Acc√®s √† un logement social adapt√© (T2) avec conditions d√©centes",
    currentStatus: "Demande HLM en cours",
    targetDate: "Fin 2025"
  },
  {
    category: "Sant√©",
    priority: "Moyenne",
    description: "Am√©lioration de l'acc√®s aux soins dentaires et ophtalmologiques",
    currentStatus: "Non couvert par CMU-C",
    targetDate: "2026"
  },
  {
    category: "Social",
    priority: "Haute",
    description: "D√©veloppement du r√©seau de soutien informel",
    currentStatus: "R√©seau limit√© mais en croissance",
    targetDate: "Continu"
  },
  {
    category: "Professionnel",
    priority: "Moyenne",
    description: "Acc√®s √† un emploi adapt√© ou activit√© b√©n√©vole structurante",
    currentStatus: "Projet associatif en d√©veloppement",
    targetDate: "2026"
  }
];
---

<MainLayout title="R√©alit√©s Sociales">
  <div class="container">
    <!-- En-t√™te -->
    <header class="page-header">
      <h1>R√©alit√©s Sociales et Logement</h1>
      <p class="subtitle">Situation actuelle et suivi social</p>
    </header>

    <!-- Navigation secondaire -->
    <nav class="secondary-nav" aria-label="Navigation sociale">
      <ul>
        <li><a href="#housing">Logement Actuel</a></li>
        <li><a href="#hlm">Demande HLM</a></li>
        <li><a href="#resources">Ressources Financi√®res</a></li>
        <li><a href="#network">R√©seau de Soutien</a></li>
        <li><a href="#needs">Besoins Identifi√©s</a></li>
      </ul>
    </nav>

    <!-- Section Logement Actuel -->
    <section id="housing" class="housing-section card">
      <h2>Situation de Logement Actuelle</h2>

      <div class="housing-summary">
        <h3>R√©sum√©</h3>
        <div class="summary-grid">
          <div class="summary-item">
            <span class="label">Localisation:</span>
            <span class="value">{socialData.currentSituation.location}</span>
          </div>
          <div class="summary-item">
            <span class="label">Type:</span>
            <span class="value">{socialData.currentSituation.housingType}</span>
          </div>
          <div class="summary-item">
            <span class="label">Loyer:</span>
            <span class="value">{socialData.currentSituation.rent}</span>
          </div>
          <div class="summary-item">
            <span class="label">Emm√©nagement:</span>
            <span class="value">{socialData.currentSituation.moveInDate}</span>
          </div>
        </div>
      </div>

      <div class="housing-conditions">
        <h3>Conditions du Logement</h3>
        <div class="conditions-grid">
          {Object.entries(socialData.currentSituation.housingConditions).map(([key, value]) => (
            <div class="condition-item">
              <span class="condition-label">{key}:</span>
              <span class="condition-value">{value}</span>
            </div>
          ))}
        </div>

        <div class="housing-alert alert-warning">
          <strong>Alertes:</strong> Conditions de logement pr√©caires n√©cessitant une intervention prioritaire.
        </div>
      </div>

      <div class="housing-photos">
        <h3>Photos du Logement</h3>
        <div class="photo-grid">
          <div class="photo-placeholder">
            <div class="photo-icon">üì∑</div>
            <p>Ext√©rieur du logement</p>
          </div>
          <div class="photo-placeholder">
            <div class="photo-icon">üì∑</div>
            <p>Int√©rieur - Espace principal</p>
          </div>
          <div class="photo-placeholder">
            <div class="photo-icon">üì∑</div>
            <p>Installation de chauffage</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Section Demande HLM -->
    <section id="hlm" class="hlm-section card">
      <h2>Demande de Logement Social (HLM)</h2>

      <div class="hlm-status">
        <h3>Statut: {hlmApplication.status}</h3>
        <div class="status-indicator {hlmApplication.status === 'En instruction' ? 'in-progress' : hlmApplication.status === 'Accept√©e' ? 'accepted' : 'rejected'}">
          {hlmApplication.status}
        </div>
      </div>

      <div class="hlm-details">
        <div class="detail-grid">
          <div class="detail-item">
            <span class="label">R√©f√©rence:</span>
            <span class="value">{hlmApplication.reference}</span>
          </div>
          <div class="detail-item">
            <span class="label">Date de d√©p√¥t:</span>
            <span class="value">{hlmApplication.submissionDate}</span>
          </div>
          <div class="detail-item">
            <span class="label">Niveau de priorit√©:</span>
            <span class="value">{hlmApplication.priorityLevel}</span>
          </div>
          <div class="detail-item">
            <span class="label">D√©lai estim√©:</span>
            <span class="value">{hlmApplication.expectedTimeline}</span>
          </div>
        </div>
      </div>

      <div class="hlm-timeline">
        <h3>Suivi de la Demande</h3>
        <div class="timeline-container">
          {hlmApplication.followUp.map((step, index) => (
            <div class="timeline-step">
              <div class="step-date">{step.date}</div>
              <div class="step-content">
                <div class="step-action">{step.action}</div>
                <div class="step-status">{step.status}</div>
              </div>
              {index < hlmApplication.followUp.length - 1 && <div class="step-connector"></div>}
            </div>
          ))}
        </div>
      </div>

      <div class="hlm-documents">
        <h3>Documents Fourni</h3>
        <ul>
          {hlmApplication.supportingDocuments.map(doc => (
            <li>{doc}</li>
          ))}
        </ul>
      </div>
    </section>

    <!-- Section Ressources -->
    <section id="resources" class="resources-section card">
      <h2>Ressources Financi√®res et Aides</h2>

      <div class="resource-grid">
        <div class="resource-card">
          <h3>Allocation Adulte Handicap√© (AAH)</h3>
          <p><strong>Statut:</strong> {socialData.resources.aah.status}</p>
          <p><strong>Montant:</strong> {socialData.resources.aah.amount}</p>
          <p><strong>P√©riode:</strong> {socialData.resources.aah.startDate} - {socialData.resources.aah.endDate}</p>
          <p><strong>R√©f√©rence:</strong> {socialData.resources.aah.reference}</p>
          <div class="resource-status {socialData.resources.aah.status === 'B√©n√©ficiaire' ? 'active' : 'pending'}">
            {socialData.resources.aah.status}
          </div>
        </div>

        <div class="resource-card">
          <h3>Aide au Logement (APL)</h3>
          <p><strong>Statut:</strong> {socialData.resources.housingBenefits.status}</p>
          <p><strong>Type:</strong> {socialData.resources.housingBenefits.type}</p>
          <p><strong>Montant:</strong> {socialData.resources.housingBenefits.amount}</p>
          <p><strong>D√©but:</strong> {socialData.resources.housingBenefits.startDate}</p>
          <div class="resource-status {socialData.resources.housingBenefits.status === 'En cours' ? 'active' : 'pending'}">
            {socialData.resources.housingBenefits.status}
          </div>
        </div>

        <div class="resource-card">
          <h3>Aide Alimentaire</h3>
          <p><strong>Statut:</strong> {socialData.resources.foodAssistance.status}</p>
          <p><strong>Type:</strong> {socialData.resources.foodAssistance.type}</p>
          <p><strong>Fr√©quence:</strong> {socialData.resources.foodAssistance.frequency}</p>
          <p><strong>Fournisseur:</strong> {socialData.resources.foodAssistance.provider}</p>
          <div class="resource-status {socialData.resources.foodAssistance.status === '√âligible' ? 'active' : 'pending'}">
            {socialData.resources.foodAssistance.status}
          </div>
        </div>
      </div>

      <div class="budget-summary">
        <h3>R√©sum√© Budg√©taire Mensuel</h3>
        <table class="table">
          <thead>
            <tr>
              <th>Source</th>
              <th>Montant</th>
              <th>D√©tails</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>AAH</td>
              <td>{socialData.resources.aah.amount}</td>
              <td>Revenu principal</td>
            </tr>
            <tr>
              <td>APL</td>
              <td>{socialData.resources.housingBenefits.amount}</td>
              <td>Aide au logement</td>
            </tr>
            <tr>
              <td>Aide alimentaire</td>
              <td>Est. 80‚Ç¨</td>
              <td>√âpicerie sociale</td>
            </tr>
            <tr>
              <td><strong>Total ressources</strong></td>
              <td><strong>1 119,86‚Ç¨</strong></td>
              <td></td>
            </tr>
            <tr>
              <td>Loyer</td>
              <td>-350‚Ç¨</td>
              <td>Incluant charges</td>
            </tr>
            <tr>
              <td>D√©penses courantes</td>
              <td>-250‚Ç¨</td>
              <td>Nourriture, transport, sant√©</td>
            </tr>
            <tr>
              <td><strong>Reste √† vivre</strong></td>
              <td><strong>519,86‚Ç¨</strong></td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Section R√©seau de Soutien -->
    <section id="network" class="network-section card">
      <h2>R√©seau de Soutien</h2>

      <div class="network-category">
        <h3>Soutien Formel (Professionnel)</h3>
        <div class="support-grid">
          {supportNetwork.formal.map((support: any) => (
            <div class="support-card">
              <h4>{support.name}</h4>
              <p><strong>R√¥le:</strong> {support.role}</p>
              <p><strong>Organisation:</strong> {support.organization}</p>
              <p><strong>Contact:</strong> {support.contact}</p>
              <p><strong>Fr√©quence:</strong> {support.frequency}</p>
            </div>
          ))}
        </div>
      </div>

      <div class="network-category">
        <h3>Soutien Informel (Personnel)</h3>
        <div class="support-grid">
          {supportNetwork.informal.map((support: any) => (
            <div class="support-card">
              <h4>{support.name}</h4>
              <p><strong>R√¥le:</strong> {support.role}</p>
              <p><strong>Relation:</strong> {support.relationship}</p>
              <p><strong>Contact:</strong> {support.contact}</p>
              <p><strong>Fr√©quence:</strong> {support.frequency}</p>
            </div>
          ))}
        </div>
      </div>

      <div class="network-category">
        <h3>R√©seau Communautaire</h3>
        <div class="support-grid">
          {supportNetwork.community.map((support: any) => (
            <div class="support-card">
              <h4>{support.name}</h4>
              <p><strong>R√¥le:</strong> {support.role}</p>
              <p><strong>Activit√©s:</strong> {support.activities}</p>
              <p><strong>Contact:</strong> {support.contact}</p>
              <p><strong>Fr√©quence:</strong> {support.frequency}</p>
            </div>
          ))}
        </div>
      </div>

      <div class="network-analysis">
        <h3>Analyse du R√©seau</h3>
        <div class="analysis-chart">
          <div class="chart-item formal">
            <span class="chart-value">3</span>
            <span class="chart-label">Formel</span>
          </div>
          <div class="chart-item informal">
            <span class="chart-value">2</span>
            <span class="chart-label">Informel</span>
          </div>
          <div class="chart-item community">
            <span class="chart-value">2</span>
            <span class="chart-label">Communaut√©</span>
          </div>
        </div>
        <p>Le r√©seau de soutien est en d√©veloppement, avec un bon √©quilibre entre soutien professionnel et communautaire.</p>
      </div>
    </section>

    <!-- Section Besoins Identifi√©s -->
    <section id="needs" class="needs-section card">
      <h2>Besoins Identifi√©s et Plan d'Action</h2>

      <div class="needs-grid">
        {identifiedNeeds.map(need => (
          <div class="need-card">
            <div class="need-header">
              <h3>{need.category}</h3>
              <span class="priority-badge {need.priority === 'Haute' ? 'high' : 'medium'}">
                Priorit√© {need.priority}
              </span>
            </div>
            <div class="need-content">
              <p><strong>Description:</strong> {need.description}</p>
              <p><strong>Statut actuel:</strong> {need.currentStatus}</p>
              <p><strong>Objectif:</strong> {need.targetDate}</p>
            </div>
            <div class="need-actions">
              <button class="btn btn-sm">Voir les actions</button>
            </div>
          </div>
        ))}
      </div>

      <div class="action-plan">
        <h3>Plan d'Action Global</h3>
        <ol>
          <li>Finaliser la demande HLM avec suivi r√©gulier (priorit√© 1)</li>
          <li>D√©velopper le r√©seau de soutien informel via les activit√©s communautaires</li>
          <li>Explorer les options d'emploi adapt√© ou b√©n√©volat structur√©</li>
          <li>Am√©liorer l'acc√®s aux soins de sant√© non couverts</li>
          <li>Stabiliser la situation de logement √† moyen terme</li>
        </ol>
      </div>
    </section>

    <!-- Section Contacts Importants -->
    <section class="contacts-section card">
      <h2>Contacts Importants</h2>

      <div class="contacts-grid">
        <div class="contact-card">
          <h3>Travailleuse Sociale</h3>
          <p><strong>Nom:</strong> {socialData.socialWorker.name}</p>
          <p><strong>R√¥le:</strong> {socialData.socialWorker.role}</p>
          <p><strong>T√©l√©phone:</strong> {socialData.socialWorker.phone}</p>
          <p><strong>Email:</strong> {socialData.socialWorker.contact}</p>
          <p><strong>Fr√©quence:</strong> {socialData.socialWorker.followUpFrequency}</p>
        </div>

        <div class="contact-card">
          <h3>Urgences Sociales</h3>
          <p><strong>SAMU Social:</strong> 115</p>
          <p><strong>CMS Villeneuve:</strong> 05 53 40 12 34</p>
          <p><strong>CCAS:</strong> 05 53 40 56 78</p>
          <p><strong>Secours Populaire:</strong> 05 53 40 90 12</p>
        </div>

        <div class="contact-card">
          <h3>Ressources Locales</h3>
          <p><strong>√âpicerie Sociale:</strong> 15 Rue de la R√©publique</p>
          <p><strong>Byblos:</strong> 23 Avenue de Paris</p>
          <p><strong>Repair Caf√©:</strong> 10 Place Lafayette</p>
          <p><strong>M√©diath√®que:</strong> 5 Rue du Coll√®ge</p>
        </div>
      </div>
    </section>
  </div>

  <!-- Styles sp√©cifiques -->
  <style>
    .summary-grid, .detail-grid, .conditions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-md);
    }

    .summary-item, .detail-item, .condition-item {
      background-color: #f8f9fa;
      padding: var(--spacing-sm);
      border-radius: var(--border-radius);
    }

    .label {
      font-weight: 600;
      color: var(--color-primary);
    }

    .value {
      color: var(--color-dark);
    }

    .condition-label {
      font-weight: 600;
      margin-right: var(--spacing-sm);
    }

    .housing-alert {
      margin-top: var(--spacing-md);
      padding: var(--spacing-sm);
    }

    .photo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
      margin-top: var(--spacing-md);
    }

    .photo-placeholder {
      background-color: #f8f9fa;
      padding: var(--spacing-lg);
      border-radius: var(--border-radius);
      text-align: center;
      border: 2px dashed #ddd;
    }

    .photo-icon {
      font-size: 3rem;
      margin-bottom: var(--spacing-sm);
    }

    .hlm-status {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-md);
    }

    .status-indicator {
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .status-indicator.in-progress {
      background-color: var(--color-warning);
      color: white;
    }

    .status-indicator.accepted {
      background-color: var(--color-success);
      color: white;
    }

    .status-indicator.rejected {
      background-color: var(--color-danger);
      color: white;
    }

    .timeline-container {
      margin-top: var(--spacing-md);
      padding-left: var(--spacing-md);
      position: relative;
    }

    .timeline-step {
      position: relative;
      padding-left: var(--spacing-lg);
      margin-bottom: var(--spacing-md);
    }

    .step-date {
      font-weight: 600;
      color: var(--color-secondary);
      margin-bottom: var(--spacing-sm);
    }

    .step-content {
      background-color: #f8f9fa;
      padding: var(--spacing-sm);
      border-radius: var(--border-radius);
    }

    .step-action {
      font-weight: 600;
    }

    .step-connector {
      position: absolute;
      left: calc(var(--spacing-lg) / 2);
      top: calc(var(--spacing-lg) * -1);
      bottom: calc(var(--spacing-md) * -1);
      width: 2px;
      background-color: var(--color-secondary);
    }

    .timeline-step:last-child .step-connector {
      display: none;
    }

    .resource-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .resource-card {
      background-color: white;
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
    }

    .resource-status {
      display: inline-block;
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-top: var(--spacing-sm);
    }

    .resource-status.active {
      background-color: var(--color-success);
      color: white;
    }

    .resource-status.pending {
      background-color: var(--color-warning);
      color: white;
    }

    .support-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-md);
    }

    .support-card {
      background-color: white;
      padding: var(--spacing-sm);
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
    }

    .network-category {
      margin-bottom: var(--spacing-lg);
    }

    .analysis-chart {
      display: flex;
      gap: var(--spacing-md);
      justify-content: center;
      margin: var(--spacing-md) 0;
    }

    .chart-item {
      text-align: center;
      padding: var(--spacing-sm);
      border-radius: var(--border-radius);
      width: 80px;
    }

    .chart-item.formal {
      background-color: var(--color-secondary);
      color: white;
    }

    .chart-item.informal {
      background-color: var(--color-success);
      color: white;
    }

    .chart-item.community {
      background-color: var(--color-warning);
      color: white;
    }

    .chart-value {
      display: block;
      font-size: 1.5rem;
      font-weight: 700;
    }

    .needs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--spacing-md);
    }

    .need-card {
      background-color: white;
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
      overflow: hidden;
    }

    .need-header {
      background-color: var(--color-primary);
      color: white;
      padding: var(--spacing-sm) var(--spacing-md);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .priority-badge {
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .priority-badge.high {
      background-color: var(--color-danger);
    }

    .priority-badge.medium {
      background-color: var(--color-warning);
    }

    .need-content {
      padding: var(--spacing-md);
    }

    .need-actions {
      background-color: #f8f9fa;
      padding: var(--spacing-sm) var(--spacing-md);
      text-align: right;
      border-top: 1px solid #ddd;
    }

    .contacts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-md);
    }

    .contact-card {
      background-color: white;
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
    }

    @media (max-width: 768px) {
      .resource-grid, .support-grid, .needs-grid, .contacts-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</MainLayout>