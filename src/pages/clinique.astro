---
// PAGE B : PROFIL CLINIQUE
// Bloc Diagnostic : Score ADOS-2 (Total : 11)
// Bloc Pharmacopée : Tableau comparatif Ancien vs Nouveau traitement
// Bloc Auto-évaluations : Emplacements pour Beck et Questionnaire Ouvert

import MainLayout from '../layouts/MainLayout.astro';

// Props pour le layout
const pageTitle = 'Profil Clinique';
const showHero = true;
const heroTitle = 'Profil Clinique';
const heroDescription = 'Diagnostics, pharmacopée et auto-évaluations';
const breadcrumbs = [
  { label: 'Profil Clinique' }
];

// Données pour le diagnostic ADOS-2
const ados2Scores = {
  total: 11,
  domains: [
    { name: 'Communication Sociale', score: 6, range: '0-10' },
    { name: 'Interaction Sociale Réciproque', score: 5, range: '0-14' },
    { name: 'Jeu et Imagination', score: 0, range: '0-8' },
    { name: 'Comportements Stéréotypés', score: 0, range: '0-8' }
  ],
  date: '15/11/2024',
  evaluator: 'Dr. Martin - CMP Villeneuve-sur-Lot',
  interpretation: 'Score total de 11 correspondant à un diagnostic de Trouble du Spectre de l\'Autisme (TSA) de niveau 1'
};

// Données pour la pharmacopée
const currentMedications = [
  { name: 'Escitalopram', dosage: '15mg', frequency: '1x/jour', startDate: '15/11/2024', prescriber: 'Dr. Martin', indication: 'Traitement de fond dépression' },
  { name: 'Agomélatine', dosage: '25mg', frequency: '1x/jour (soir)', startDate: '15/11/2024', prescriber: 'Dr. Martin', indication: 'Régulation sommeil/humeur' },
  { name: 'Mélatonine', dosage: '2mg', frequency: 'Au coucher', startDate: '01/12/2024', prescriber: 'Dr. Dubois', indication: 'Troubles du sommeil' }
];

const previousMedications = [
  { name: 'Paroxétine', dosage: '20mg', frequency: '1x/jour', period: '2018-2022', reason: 'Arrêt pour effets secondaires' },
  { name: 'Sertraline', dosage: '50mg', frequency: '1x/jour', period: '2022-2024', reason: 'Efficacité insuffisante' }
];
---

<MainLayout 
  title={pageTitle} 
  showHero={showHero}
  heroTitle={heroTitle}
  heroDescription={heroDescription}
  breadcrumbs={breadcrumbs}
>
  <!-- Section : Diagnostic ADOS-2 -->
  <section class="diagnostic-section card">
    <h2>Diagnostic - Évaluation ADOS-2</h2>
    
    <div class="diagnostic-summary">
      <div class="score-card">
        <div class="score-value">{ados2Scores.total}</div>
        <div class="score-label">Score Total ADOS-2</div>
        <div class="score-date">Évaluation du {ados2Scores.date}</div>
      </div>
      
      <div class="diagnostic-details">
        <h3>Interprétation Clinique</h3>
        <p>{ados2Scores.interpretation}</p>
        
        <div class="evaluator-info">
          <p><strong>Évaluateur :</strong> {ados2Scores.evaluator}</p>
        </div>
      </div>
    </div>

    <!-- Tableau des scores par domaine -->
    <div class="domain-scores">
      <h3>Scores par Domaine</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Domaine</th>
            <th>Score</th>
            <th>Plage de référence</th>
            <th>Interprétation</th>
          </tr>
        </thead>
        <tbody>
          {ados2Scores.domains.map((domain) => (
            <tr>
              <td>{domain.name}</td>
              <td><strong>{domain.score}</strong></td>
              <td>{domain.range}</td>
              <td>
                {domain.score >= 6 ? 'Significatif' : domain.score >= 3 ? 'Modéré' : 'Faible/Nul'}
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
    
    <div class="section-note">
      <p><em>[CONTENU À REMPLIR - OBSERVATIONS COMPLÉMENTAIRES ET ÉVOLUTION]</em></p>
    </div>
  </section>

  <!-- Section : Pharmacopée -->
  <section class="pharmacopoeia-section card">
    <h2>Pharmacopée - Traitements en cours</h2>
    
    <div class="treatment-comparison">
      <div class="current-treatments">
        <h3>Traitements Actuels</h3>
        <table class="table">
          <thead>
            <tr>
              <th>Médicament</th>
              <th>Dosage</th>
              <th>Fréquence</th>
              <th>Début</th>
              <th>Prescrit par</th>
              <th>Indication</th>
            </tr>
          </thead>
          <tbody>
            {currentMedications.map((med) => (
              <tr>
                <td>{med.name}</td>
                <td>{med.dosage}</td>
                <td>{med.frequency}</td>
                <td>{med.startDate}</td>
                <td>{med.prescriber}</td>
                <td>{med.indication}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
      
      <div class="previous-treatments">
        <h3>Traitements Antérieurs</h3>
        <table class="table">
          <thead>
            <tr>
              <th>Médicament</th>
              <th>Dosage</th>
              <th>Fréquence</th>
              <th>Période</th>
              <th>Raison de l'arrêt</th>
            </tr>
          </thead>
          <tbody>
            {previousMedications.map((med) => (
              <tr>
                <td>{med.name}</td>
                <td>{med.dosage}</td>
                <td>{med.frequency}</td>
                <td>{med.period}</td>
                <td>{med.reason}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section-note">
      <p><em>[CONTENU À REMPLIR - EFFETS SECONDAIRES, TOLÉRANCE ET ADHÉRENCE]</em></p>
    </div>
  </section>

  <!-- Section : Auto-évaluations -->
  <section class="self-assessment-section card">
    <h2>Auto-évaluations et Questionnaires</h2>
    
    <div class="assessment-grid">
      <!-- Beck Depression Inventory -->
      <div class="assessment-card">
        <h3>Inventaire de Dépression de Beck (BDI)</h3>
        <div class="assessment-placeholder">
          <p><strong>Dernière passation :</strong> [CONTENU À REMPLIR - DATE]</p>
          <p><strong>Score total :</strong> [CONTENU À REMPLIR - SCORE]</p>
          <p><strong>Interprétation :</strong> [CONTENU À REMPLIR - NIVEAU]</p>
          <div class="placeholder-content">
            <p><em>Graphique d'évolution à insérer ici</em></p>
          </div>
        </div>
      </div>
      
      <!-- Questionnaire Ouvert -->
      <div class="assessment-card">
        <h3>Questionnaire Ouvert - État Actuel</h3>
        <div class="assessment-placeholder">
          <p><strong>Dernière mise à jour :</strong> [CONTENU À REMPLIR - DATE]</p>
          <div class="placeholder-content">
            <p><em>[CONTENU À REMPLIR - DESCRIPTION SUBJECTIVE DE L'ÉTAT ACTUEL, DIFFICULTÉS RENCONTRÉES, PROGRÈS RÉALISÉS]</em></p>
            <p><em>[CONTENU À REMPLIR - BESOINS IDENTIFIÉS ET ATTENTES VIS-À-VIS DU SUIVI]</em></p>
          </div>
        </div>
      </div>
      
      <!-- Échelles complémentaires -->
      <div class="assessment-card">
        <h3>Échelles Complémentaires</h3>
        <div class="assessment-placeholder">
          <p><strong>Échelle d'Anxiété de Hamilton (HAM-A) :</strong> [CONTENU À REMPLIR]</p>
          <p><strong>Échelle de Qualité de Vie (WHOQOL) :</strong> [CONTENU À REMPLIR]</p>
          <p><strong>Échelle de Fonctionnement Social (SFS) :</strong> [CONTENU À REMPLIR]</p>
          <div class="placeholder-content">
            <p><em>[CONTENU À REMPLIR - SYNTHÈSE DES ÉVALUATIONS COMPLÉMENTAIRES]</em></p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Styles spécifiques à la page -->
  <style>
    /* ----------------------------------------------------------------------
       DIAGNOSTIC ADOS-2
       ---------------------------------------------------------------------- */
    .diagnostic-summary {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: var(--spacing-xl);
      align-items: center;
      margin-bottom: var(--spacing-xl);
    }

    .score-card {
      text-align: center;
      padding: var(--spacing-lg);
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      color: var(--color-white);
      border-radius: var(--border-radius-lg);
      min-width: 200px;
    }

    .score-value {
      font-size: 4rem;
      font-weight: 700;
      line-height: 1;
      margin-bottom: var(--spacing-sm);
    }

    .score-label {
      font-size: 1.125rem;
      margin-bottom: var(--spacing-xs);
    }

    .score-date {
      font-size: 0.875rem;
      opacity: 0.9;
    }

    .diagnostic-details h3 {
      margin-bottom: var(--spacing-md);
      color: var(--color-primary);
      border-bottom: none;
    }

    .evaluator-info {
      margin-top: var(--spacing-md);
      padding-top: var(--spacing-md);
      border-top: 1px solid var(--color-gray-200);
    }

    .domain-scores {
      margin-top: var(--spacing-xl);
    }

    .domain-scores h3 {
      margin-bottom: var(--spacing-md);
      color: var(--color-primary);
      border-bottom: none;
    }

    /* ----------------------------------------------------------------------
       PHARMACOPÉE
       ---------------------------------------------------------------------- */
    .treatment-comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-xl);
      margin-bottom: var(--spacing-lg);
    }

    .current-treatments h3,
    .previous-treatments h3 {
      margin-bottom: var(--spacing-md);
      color: var(--color-primary);
      border-bottom: none;
    }

    /* ----------------------------------------------------------------------
       AUTO-ÉVALUATIONS
       ---------------------------------------------------------------------- */
    .assessment-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--spacing-lg);
    }

    .assessment-card {
      padding: var(--spacing-lg);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-md);
      background-color: var(--color-white);
    }

    .assessment-card h3 {
      margin-bottom: var(--spacing-md);
      color: var(--color-primary);
      border-bottom: none;
    }

    .assessment-placeholder p {
      margin-bottom: var(--spacing-sm);
      padding-bottom: var(--spacing-xs);
      border-bottom: 1px solid var(--color-gray-100);
    }

    .assessment-placeholder p:last-child {
      border-bottom: none;
    }

    .placeholder-content {
      margin-top: var(--spacing-md);
      padding: var(--spacing-md);
      background-color: var(--color-gray-50);
      border-radius: var(--border-radius-md);
      border-left: 4px solid var(--color-gray-400);
    }

    .placeholder-content p {
      margin-bottom: var(--spacing-sm);
      font-style: italic;
      color: var(--color-gray-600);
    }

    .placeholder-content p:last-child {
      margin-bottom: 0;
    }

    /* ----------------------------------------------------------------------
       RESPONSIVE DESIGN
       ---------------------------------------------------------------------- */
    @media (max-width: 992px) {
      .diagnostic-summary {
        grid-template-columns: 1fr;
        text-align: center;
      }

      .score-card {
        margin: 0 auto;
      }

      .treatment-comparison {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .assessment-grid {
        grid-template-columns: 1fr;
      }

      .score-card {
        min-width: auto;
        padding: var(--spacing-md);
      }

      .score-value {
        font-size: 3rem;
      }
    }

    @media (max-width: 480px) {
      .diagnostic-summary,
      .treatment-comparison,
      .assessment-grid {
        gap: var(--spacing-md);
      }

      .assessment-card {
        padding: var(--spacing-md);
      }

      .table {
        font-size: 0.75rem;
      }

      .table th,
      .table td {
        padding: var(--spacing-xs);
      }
    }
  </style>
</MainLayout>